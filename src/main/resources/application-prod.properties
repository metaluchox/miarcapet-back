# ============================================
# PERFIL DE PRODUCCIÓN
# ============================================
# Este perfil se usa cuando se despliega el WAR en producción
# Para activar: java -jar miarcapet.war --spring.profiles.active=prod
# O configurar en el servidor de aplicaciones

# ============================================
# CONFIGURACIÓN DE BASE DE DATOS - POSTGRESQL PRODUCCIÓN
# ============================================
# IMPORTANTE: Cambiar estas credenciales por las de producción
# Recomendado: Usar variables de entorno en lugar de hardcodear
spring.datasource.url=${DATABASE_URL:jdbc:postgresql://localhost:5432/miarcapet}
spring.datasource.username=${DATABASE_USERNAME:postgres}
spring.datasource.password=${DATABASE_PASSWORD:tito}
spring.datasource.driverClassName=org.postgresql.Driver

# Configuración de pool de conexiones para producción
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# Dialecto PostgreSQL para Hibernate
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect

# PRODUCCIÓN: NO crear/actualizar tablas automáticamente
# validate: Solo valida que el esquema coincida con las entidades
spring.jpa.hibernate.ddl-auto=validate

# NO mostrar SQL en producción (por rendimiento y seguridad)
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# Propiedades adicionales de PostgreSQL
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# ============================================
# CONFIGURACIÓN DE LOGGING - PRODUCCIÓN
# ============================================
# Nivel de logging mínimo en producción
logging.level.cl.project.miarcapet=INFO
logging.level.org.springframework.security=WARN
logging.level.org.springframework.web=WARN
logging.level.org.hibernate=WARN

# Archivo de logs para producción
logging.file.name=logs/miarcapet.log
logging.file.max-size=10MB
logging.file.max-history=30

# Patrón de logging para producción
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ============================================
# CONFIGURACIÓN JWT - PRODUCCIÓN
# ============================================
# IMPORTANTE: Usar variables de entorno para la clave JWT en producción
jwt.secret-key=${JWT_SECRET_KEY:404E635266556A586E3272357538782F413F4428472B4B6250645367566B5970337336763979244226452948404D635166546A576E5A7234753778214125442A}
jwt.expiration=${JWT_EXPIRATION:86400000}

# ============================================
# CONFIGURACIÓN DE DEVTOOLS - DESHABILITADO
# ============================================
spring.devtools.restart.enabled=false
spring.devtools.livereload.enabled=false

# ============================================
# SWAGGER/OPENAPI - DESHABILITADO EN PRODUCCIÓN
# ============================================
# Por seguridad, deshabilitar Swagger en producción
springdoc.swagger-ui.enabled=false
springdoc.api-docs.enabled=false

# ============================================
# CONFIGURACIÓN DE SEGURIDAD ADICIONAL
# ============================================
# Deshabilitar open-in-view para mejor rendimiento
spring.jpa.open-in-view=false

# Configuración de errores en producción
server.error.include-message=never
server.error.include-binding-errors=never
server.error.include-stacktrace=never
server.error.include-exception=false

# ============================================
# CONFIGURACIÓN DEL SERVIDOR
# ============================================
# Puerto del servidor (puede ser sobrescrito por el servidor de aplicaciones)
server.port=${PORT:8080}

# Configuración de compresión
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json

# ============================================
# NOTAS IMPORTANTES PARA PRODUCCIÓN
# ============================================
# 1. Variables de entorno recomendadas:
#    - DATABASE_URL: URL completa de PostgreSQL
#    - DATABASE_USERNAME: Usuario de la base de datos
#    - DATABASE_PASSWORD: Contraseña de la base de datos
#    - JWT_SECRET_KEY: Clave secreta para JWT (generar nueva con: openssl rand -base64 64)
#    - JWT_EXPIRATION: Tiempo de expiración del token en ms
#
# 2. Antes de desplegar:
#    - Crear las tablas manualmente o con Flyway/Liquibase
#    - Cambiar ddl-auto a 'validate'
#    - Configurar backup de la base de datos
#    - Usar HTTPS en producción
#    - Revisar logs periódicamente
#
# 3. Para desplegar el WAR:
#    mvn clean package -Pprod
#    Copiar target/miarcapet.war al servidor
#    Configurar las variables de entorno en el servidor
